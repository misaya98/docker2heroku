name: Deploy Docker Image to Heroku

on:
  workflow_dispatch:
    inputs:
      heroku_app_name:
        description: 'The name of the Heroku app (optional)'
        required: false
        type: string
      create_new_app:
        description: 'Check this box to create a new Heroku app'
        required: false
        type: boolean
        default: false
      docker_image:
        description: 'The full Docker Hub image name and tag (e.g., your-username/your-image:latest)'
        required: true
        type: string
      heroku_config_vars:
        description: 'Heroku config variables (one per line, e.g., KEY=VALUE)'
        required: false
        type: string

jobs:
  deploy-to-heroku:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Heroku
        uses: misaya98/docker2heroku@main

        with:
          heroku_api_key: ${{ secrets.HEROKU_API_KEY }}
          
          docker_image: 'lobehub/lobe-chat:latest'
          heroku_app_name: ''
          create_new_app: 'true' # 注意：布尔值在这里应作为字符串 'true' 或 'false' 传入
          
          heroku_config_vars: |
            A=B

          # dockerhub_username: ${{ secrets.DOCKERHUB_USERNAME }}
          # dockerhub_token: ${{ secrets.DOCKERHUB_TOKEN }}
